# GitHub Actions workflow for mmtwfs testing and continuous integration.
#
# This file performs testing using tox and tox.ini to define and configure the test environments.

name: CI Tests

on:
  push:
    branches:
    - main
    tags:
    - '*'
  pull_request:

# Use the OpenAstronomy re-usable workflow that handles the dirty work of setting up
# workers and running tox.
jobs:
  test:
    uses: OpenAstronomy/github-actions-workflows/.github/workflows/tox.yml@v1
    with:
      envs: |
        - linux: codestyle
          pytest: false
        - linux: py312-alldeps-cov
          name: py312
        - macos: py312
          name: py312-macos
        - linux: py312-astropydev
          name: py312-astropy-latest
          continue-on-error: true
        - linux: py312-numpydev
          name: py312-numpy-latest
          continue-on-error: true
        - linux: py313-alldeps
          name: py313
          continue-on-error: true
        - linux: build_docs
        - linux: linkcheck
      coverage: 'codecov'
    secrets:
      CODECOV_TOKEN: ${{ secrets.CODECOV }}
